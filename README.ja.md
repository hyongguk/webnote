[English](README.ja.md)

# 📒webnote

ブラウザで使えるnoteアプリ。noteはデータベースに保存されます。
入力されたノートは自動でデータベースに保存されます。保存が完了したかどうかはノートリストを見れば確認できます。
ノートは更新された順に整頓され、最後にとったノートにすぐにアクセスできます。


<br/>
<br/>
<br/>
<br/>
<h2>🤼‍Dependencies<h2/>

axios: 0.21.0<br/>
bcrypt: 5.0<br/>
bcrypt: 5.0.0<br/>
bootstrap: 4.5.2<br/>
bootstrap-vue: 2.17.3<br/>
connect-flash: 0.1.1<br/>
cookie-parser": 1.4.5<br/>
cookie-session: 1.4.0<br/>
core-js: 3.6.4<br/>
cors: 2.8.5<br/>
dotenv: 8.2.0<br/>
eslint: 7.9.0<br/>
express: 4.16.3<br/>
express-flash: 0.0.2<br/>
express-session: 1.17.1<br/>
knex: 0.21.0<br/>
moment: 2.22.2<br/>
morgan: 1.9.0<br/>
passport: 0.4.1<br/>
passport-local: 1.0.0<br/>
pg: 8.0.2<br/>
vue: 2.6.12<br/>
vue-axios: 3.2.0<br/>
vue-router: 3.4.9<br/>

<br/>
<br/>
<br/>

<h2>🔥DEMO</h2>
.作成ボタンを押すだけで、ノートを新規作成しデータベースに新たなノートを記録します。ノートにタイトルを入力すればリアルタイムでノートリストにタイトルと記録した時間が反映されます。
<img src="./assets/ノート作成.gif"/>
<br/>
<br/>
<br/>
ノートへの入力は一文字づつ検知されますが連続で打つ場合は敢えて保存せずに、入力が数秒行われないとデータベースに記録します。記録されてない場合、ローディングアニメーションが表示されます。
<img src="./assets/自動保存.gif" />
<br/>
<br/>
<br/>
ノートは編集された順に上からソートされます。
<img src="./assets/自動ソート.gif" />
<br/>
<br/>
<br/>
<h2>🚀How It Works</h2>

#### サインアップ / サインイン

form から受け取ったユーザーデータを同期処理を実行してサイバーサイドにリクエストを送ります。　
クライアントサイドからのリクエストをサーバーサイドで受け取り認証ミドルウェア Passport.js の Local Strategy を用いてユーザーを認証します。
サインアップの場合、データベースにユーザーがすでに存在していないかを確認し、なければパスワードを bcrypt を用いてハッシュ化してメールアドレスともにデータベースに保存します。
サインインの場合、サインアップ時に登録した情報を元に認証を行ます。認証がされるとセッションを開始し以後一定期間内はその情報を元にクライアントからのリクエストの認証を行ます。
<br/>
<br/>
<br/>
#### ノート一覧表示

サーバーで認証が成功すると、ホーム画面にリダイレクトしライフサイクルフックを使って GET リクエストを送り、サーバーはデーターベースからログインしたユーザーのノートを更新日順にソートして全てクライアントサイドにレスポンスとして返します。
ブラウザでは json 形式で受け取った ノートの配列を data プロパティに格納し値の変化を監視できるようにし、ノートのタイトルと更新日だけをリストレンダリングし一覧表示させます。
<br/>
<br/>
<br/>
#### ノート編集

画面の左側あるノートリストからタイトルを選択するとそのタイトルがハイライトされ右側にノートの詳細がレンダリングされます。ノート詳細コンポーネントは バインディングを用いてノートリストとつながっているので、ノートに入力されたタイトルは親コンポーネントであるノートリストに反映されます。また、ノートへの入力が確認されるとノートリストにある最終更新時間が更新され、自動でリストは更新時間順にソートされます。
<br/>
<br/>
<br/>

#### オートセーブ

ノートに入力が確認されるたびにデータベースにノート変更を反映させる PUT リクエストを送る関数が実行されます。ただし、多く素早くの入力をする場合、１つの入力ごとにサーバーにリクエストをおくるのは負担がかかる可能性があるので、入力から２秒以内に新たな入力が認識されるとサーバーへのリクエストはさらに２秒後に延期されます。つまり入力から２秒間新しい入力がなければサーバーへリクエストを送ります。
<br/>
<br/>
<br/>

#### ノートの削除と追加

ノートの削除ボタンがクリックされるとdataクラスのプロパティからノートに関するデータが削除され、データベースにDELETE リクエストを送ります。
ノートの追加ボタンがクリックされると新しいノートのオブジェクトをプロパティに作成し POST リクエストをサバーサイドに送信します。サーバーではデータベースのノートテーブルにタイトルと本文が空の列を作成します。
<br/>
<br/>
<br/>
#### 検索

検索バーにキーワード入力すると、そのキーワードを含むノートを全てデータベースから抽出しレスポンスとしてクライアントサイドに結果を返し一覧表示します。
<br/>
<br/>
<br/>
<br/>
<h2>Tech Stack</h2>

### frontend
* javascritpt
* Vue.js
* Vue.router
* Vue-Bootstrap

### backend
* Node.js
* passport.js
* knex
* Express
* PostgreSQL

